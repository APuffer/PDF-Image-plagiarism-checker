# 简易PDF图片查重

![License=MIT](https://img.shields.io/badge/License-MIT-auto)
![Python=3.12.8](https://img.shields.io/badge/Python-3.12.8-blue)

## 环境准备

安装依赖库
```cmd
pip install -r requirements.txt
```

## 操作流程

### 第一步：放置PDF文件
1. 在程序文件夹内新建「纯论文」文件夹
2. 将需要查重的PDF文件直接拖入该文件夹
   - 重要提示：请保持PDF文件名格式为`1234队X题.pdf`

### 第二步：生成分类文件
双击运行 main.py，程序将：
- 自动提取所有PDF文件的图片
- 生成图片的特征
- 处理完成后，会生成`classify.csv`文件，表示分类完成

### 第三步：查看查重结果
1. 双击运行 visualize.py
2. 等待浏览器自动打开（约5秒）
3. 网页显示：
    - 每一类中有几个队伍
    - 每被判为相似的一类图片的预览
    - 这些图片所属的队伍、图片所在页数和编号

> 注意：
> 图片查重中会包含来自同一个队伍的图片，但一个类别如果完全来自同一个队伍，该类别将隐藏。

## 常见问题

- 依赖安装失败
  - 确保网络连接正常
  - 确认Python版本为3.12.8
  - 尝试使用管理员权限运行命令
  - 尝试使用镜像源或VPN

- 浏览器未自动打开
  - 手动访问 http://localhost:8000
  - 看网页时不要关掉那个小黑框！
  - 检查防火墙设置

- 处理时间较长/进度条走不动？
  - 这是正常现象，50篇论文需要约3分钟处理。
    - 理论上时间复杂度是二次的，但实际上最耗时的部分是图片IO和大图片的特征提取，所以近似线性
  - 进度条是随便做的，每次更新取决于cpu心情，不影响实际处理速度
  - 欢迎提交pr优化进度条

- 注意事项
  - 处理过程中不要修改文件位置
  - 不要打开文件

## 算法细节
- 数据预处理
  对于饱和度尤其低的图片，视为无效图片，不参与处理。这些图存放在`各论文图片/疑似灰图`中。
  对于像素数量尤其少的图片，视为PDF排版用图，直接丢弃。

- 图片特征提取
  由于本人水平有限，难以有效提取特征，欢迎各位大佬交流意见。目前使用的特征包括：
  - 灰度直方图
  - 灰度块密度(针对图基本结构)
  - 饱和度轴向最大点(针对数据图的基本走势)
  (在feature.py中可以修改)

- 相似度计算
  目前使用DBSCAN+曼哈顿距离进行聚类。
  (在classify.py中可以修改)


